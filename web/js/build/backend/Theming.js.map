{"version":3,"sources":["backend/Theming.ts"],"names":["ImageChooser","$row","$uploadLabel","this","find","on","ev","preventDefault","src","$","currentTarget","attr","val","length","prepend","removeClass","text","data","path","split","filename","addClass","Theming","$form","_this","each","i","el","options","title","message","inputType","inputOptions","value","callback","result","$defaults","append","trigger","bootbox","prompt","exports"],"mappings":"0HAAA,IAAAA,EACI,SAAoBC,GAChB,IAAMC,GADUC,KAAAF,KAAAA,GACUG,KAAK,0BAC/BH,EAAKI,GAAG,QAAS,uBAAwB,SAAAC,GACrCA,EAAGC,iBACH,IAAMC,EAAMC,EAAEH,EAAGI,eAAeN,KAAK,OAAOO,KAAK,OACjDV,EAAKG,KAAK,sBAAsBQ,IAAIJ,GACS,IAAzCP,EAAKG,KAAK,oBAAoBS,QAC9BZ,EAAKG,KAAK,gBAAgBU,QAAQ,uBAEtCb,EAAKG,KAAK,oBAAoBO,KAAK,MAAOH,GAAKO,YAAY,UAC3Db,EAAac,KAAKd,EAAae,KAAK,UACpChB,EAAKG,KAAK,oBAAoBQ,IAAI,MAEtCX,EAAKG,KAAK,oBAAoBC,GAAG,SAAU,WACvC,IAAMa,EAAOjB,EAAKG,KAAK,oBAAoBQ,MAAMO,MAAM,MACjDC,EAAWF,EAAKA,EAAKL,OAAS,GACpCZ,EAAKG,KAAK,sBAAsBQ,IAAI,IACpCX,EAAKG,KAAK,oBAAoBiB,SAAS,UACvCnB,EAAac,KAAKI,MAK9BE,EACI,SAAoBC,GAApB,IAAAC,EAAArB,KAAoBA,KAAAoB,MAAAA,EAChBpB,KAAKoB,MAAMnB,KAAK,cAAcqB,KAAK,SAACC,EAAGC,GACnC,IAAI3B,EAAaS,EAAEkB,MAGvBxB,KAAKoB,MAAMlB,GAAG,QAAS,iBAAkB,SAACC,GACtCA,EAAGC,iBAEH,IAAMqB,EAAU,CACZC,MAAOpB,EAAEH,EAAGI,eAAeO,KAAK,iBAChCa,QAASrB,EAAEH,EAAGI,eAAeO,KAAK,mBAClCc,UAAW,QACXC,aAAc,CACV,CACIhB,KAAMP,EAAEH,EAAGI,eAAeO,KAAK,gBAC/BgB,MAAO,kBAEX,CACIjB,KAAMP,EAAEH,EAAGI,eAAeO,KAAK,aAC/BgB,MAAO,gBAGfC,SAAU,SAACC,GACP,GAAIA,EAAQ,CACR,IAAMC,EAAY3B,EAAE,mDAAmDE,KAAK,QAASwB,GACrFX,EAAKD,MAAMc,OAAO,qDAClBb,EAAKD,MAAMc,OAAOD,GAClBZ,EAAKD,MAAMe,QAAQ,aAI/BC,QAAQC,OAAOZ,MAhCda,EAAAnB,QAAAA","file":"Theming.js","sourcesContent":["class ImageChooser {\n    constructor(private $row) {\n        const $uploadLabel = $row.find('.uploadCol label .text');\n        $row.on('click', '.imageChooserDd ul a', ev => {\n            ev.preventDefault();\n            const src = $(ev.currentTarget).find(\"img\").attr(\"src\");\n            $row.find('input[type=hidden]').val(src);\n            if ($row.find('.logoPreview img').length === 0) {\n                $row.find('.logoPreview').prepend('<img src=\"\" alt=\"\">');\n            }\n            $row.find('.logoPreview img').attr('src', src).removeClass('hidden');\n            $uploadLabel.text($uploadLabel.data('title'));\n            $row.find(\"input[type=file]\").val('');\n        });\n        $row.find(\"input[type=file]\").on(\"change\", () => {\n            const path = $row.find(\"input[type=file]\").val().split('\\\\');\n            const filename = path[path.length - 1];\n            $row.find('input[type=hidden]').val('');\n            $row.find(\".logoPreview img\").addClass('hidden');\n            $uploadLabel.text(filename);\n        });\n    }\n}\n\nexport class Theming {\n    constructor(private $form: JQuery) {\n        this.$form.find('.row_image').each((i, el) => {\n            new ImageChooser($(el));\n        });\n\n        this.$form.on('click', '.btnResetTheme', (ev) => {\n            ev.preventDefault();\n\n            const options = {\n                title: $(ev.currentTarget).data(\"confirm-title\"),\n                message: $(ev.currentTarget).data(\"confirm-message\"),\n                inputType: 'radio',\n                inputOptions: [\n                    {\n                        text: $(ev.currentTarget).data(\"name-classic\"),\n                        value: 'layout-classic',\n                    },\n                    {\n                        text: $(ev.currentTarget).data(\"name-dbjr\"),\n                        value: 'layout-dbjr',\n                    }\n                ],\n                callback: (result) => {\n                    if (result) {\n                        const $defaults = $('<input type=\"hidden\" name=\"defaults\" value=\"1\">').attr(\"value\", result);\n                        this.$form.append('<input type=\"hidden\" name=\"resetTheme\" value=\"1\">');\n                        this.$form.append($defaults);\n                        this.$form.trigger(\"submit\");\n                    }\n                }\n            } as BootboxPromptOptions; // Typings of Bootbox don't support \"message\"\n            bootbox.prompt(options);\n        });\n    }\n}\n"]}